# HTML 的解析

- 拆分文件 (splitFile)

  - 为了方便文件管理，我们把 parser 单独拆到文件中，
  - parser 接收 html 文本作为参数，返回一颗 DOM 树

> 注意：下面的 6 个步骤都是为了实现这个 parser 方法

- 创建状态机（initFSM）

  - 用有限状态机来实现 HTML 的分析
  - 在 HTML 标准中，已经规定了 HTML 的状态

- 解析标签 (ParseTag)

  - 主要的标签有：开始标签、结束标签和自封闭标签
  - 在这一步暂时忽略属性

- 创建元素

  - 在状态机中，除了状态迁移，我们还要加入业务逻辑
  - 在标签结束状态，提交标签 token

- 第五步 处理属性
  - 属性值分为单引号、双引号、无引号三种写法，因此需要较多状态处理。
  - 处理属性的方式跟标签类似。
  - 属性结束时，我们把属性加到标签 token 上。
- 第六步 构建 DOM 树
  - 从标签构建 DOM 树的基本技巧是使用栈
  - 遇到开始标签时创建元素并入栈，遇到结束标签时出栈
  - 自封闭节点可视为入栈后立即出栈
  - 任何元素的父元素都是它入栈前的栈顶
- 第七步 文本节点
  - 文本节点与自封闭标签处理类似
  - 多个文本节点需要合并
